<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A future represents an asynchronous computation."><meta name="keywords" content="rust, rustlang, rust-lang, Future"><title>Future in std::future - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize1.58.0.css"><link rel="stylesheet" type="text/css" href="../../rustdoc1.58.0.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light1.58.0.css" id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark1.58.0.css" disabled=""><link rel="stylesheet" type="text/css" href="../../ayu1.58.0.css" disabled=""><script id="default-settings"></script><script src="../../storage1.58.0.js"></script><script src="../../crates1.58.0.js"></script><script defer="" src="../../main1.58.0.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript1.58.0.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x161.58.0.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x321.58.0.png"><link rel="icon" type="image/svg+xml" href="../../favicon1.58.0.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow1.58.0.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../std/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo1.58.0.png' alt='logo'></div></a><h2 class="location">Trait Future</h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#associated-types">Associated Types</a></h3><div class="sidebar-links"><a href="#associatedtype.Output">Output</a></div><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><div class="sidebar-links"><a href="#tymethod.poll">poll</a></div><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div><h2 class="location">Other items in<br><a href="../index.html">std</a>::<wbr><a href="index.html">future</a></h2><div id="sidebar-vars" data-name="Future" data-ty="trait" data-relpath=""></div><script defer="" src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush1.58.0.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel1.58.0.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Trait <a href="../index.html">std</a>::<wbr><a href="index.html">future</a>::<wbr><a class="trait" href="#">Future</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard1.58.0.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span class="since" title="Stable since Rust version 1.36.0">1.36.0</span><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/core/future/future.rs.html#32-100" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust trait"><code>pub trait Future {
    type <a href="#associatedtype.Output" class="type">Output</a>;
    fn <a href="#tymethod.poll" class="fnname">poll</a>(self: <a class="struct" href="../pin/struct.Pin.html" title="struct std::pin::Pin">Pin</a>&lt;<a class="primitive" href="../primitive.reference.html">&amp;mut </a>Self&gt;, cx: &amp;mut <a class="struct" href="../task/struct.Context.html" title="struct std::task::Context">Context</a>&lt;'_&gt;) -&gt; <a class="enum" href="../task/enum.Poll.html" title="enum std::task::Poll">Poll</a>&lt;Self::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a>&gt;;
}</code></pre></div><details class="rustdoc-toggle top-doc" open=""><summary class="hideme"><span>Expand description</span></summary><div class="docblock" xpath="/html[1]/body[1]/section[1]/details[1]/div[1]" istranslationnode="true" main_mp="Y25yZD4/YnB0dHJkPj9icGRkYnQuL1JgZGRidA==" sub_mp="[&quot;c3VkOz5jcXF1c2U7PkNxcWVjdQ==&quot;]"><p class="translate-text">未来代表异步计算。</p><p>A future represents an asynchronous computation.</p>
<p class="translate-text">未来是可能尚未完成计算的值。 这种“异步值”使得线程可以在等待值变得可用时继续做有用的工作。</p><p>A future is a value that might not have finished computing yet. This kind of
“asynchronous value” makes it possible for a thread to continue doing useful
work while it waits for the value to become available.</p>
<h2 id="the-poll-method" class="section-header"><a href="#the-poll-method">The <code>poll</code> method</a></h2>
<p class="translate-text">future 的核心方法 `poll` 试图将 future 解析为最终值。 如果值未准备好，此方法不会阻塞。 相反，当前任务被安排在可以通过再次轮询取得进一步进展时被唤醒。 传递给 `poll` 方法的 `context` 可以提供一个“Waker”，它是用于唤醒当前任务的句柄。</p><p>The core method of future, <code>poll</code>, <em>attempts</em> to resolve the future into a
final value. This method does not block if the value is not ready. Instead,
the current task is scheduled to be woken up when it’s possible to make
further progress by <code>poll</code>ing again. The <code>context</code> passed to the <code>poll</code>
method can provide a <a href="../task/struct.Waker.html"><code>Waker</code></a>, which is a handle for waking up the current
task.</p>
<p class="translate-text">使用 future 时，一般不会直接调用 poll ，而是调用 .await 的值。</p><p>When using a future, you generally won’t call <code>poll</code> directly, but instead
<code>.await</code> the value.</p>
</div></details><h2 id="associated-types" class="small-section-header">Associated Types<a href="#associated-types" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open=""><summary><div id="associatedtype.Output" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/future/future.rs.html#35" title="goto source code">[src]</a></div><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a></h4></div></summary><div class="docblock"><p>The type of value produced on completion.</p>
</div></details></div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open=""><summary><div id="tymethod.poll" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/future/future.rs.html#99" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.poll" class="fnname">poll</a>(self: <a class="struct" href="../pin/struct.Pin.html" title="struct std::pin::Pin">Pin</a>&lt;<a class="primitive" href="../primitive.reference.html">&amp;mut </a>Self&gt;, cx: &amp;mut <a class="struct" href="../task/struct.Context.html" title="struct std::task::Context">Context</a>&lt;'_&gt;) -&gt; <a class="enum" href="../task/enum.Poll.html" title="enum std::task::Poll">Poll</a>&lt;Self::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a>&gt;</h4></div></summary><div class="docblock" xpath="/html[1]/body[1]/section[1]/div[3]/details[1]/div[1]" istranslationnode="true" main_mp="Y25yZD4/YnB0dHJkPj9icGRkYnQuL1JgZGRidC4vZHpMTQ==" sub_mp="[&quot;c3VkOz5jcXF1c2U7PkNxcWVjdSsuZXt5fA==&quot;]"><p class="translate-text">尝试将未来解析为最终值，如果该值尚不可用，则注册当前任务以进行唤醒。</p><p>Attempt to resolve the future to a final value, registering
the current task for wakeup if the value is not yet available.</p>
<h5 id="return-value" class="section-header"><a href="#return-value">Return value</a></h5>
<p class="translate-text">该函数返回：</p><p>This function returns:</p>
<ul>
<li class="translate-text">如果未来尚未准备好，则为“投票::待定”</li><li><a href="../task/enum.Poll.html#variant.Pending" title="Poll::Pending"><code>Poll::Pending</code></a> if the future is not ready yet</li>
<li class="translate-text">"Poll::Ready(val)" 如果它成功完成，则带有这个未来的结果 `value`。</li><li><a href="../task/enum.Poll.html#variant.Ready"><code>Poll::Ready(val)</code></a> with the result <code>val</code> of this future if it
finished successfully.</li>
</ul>
<p class="translate-text">一旦 future 完成，客户不应该再次“轮询”它。</p><p>Once a future has finished, clients should not <code>poll</code> it again.</p>
<p class="translate-text">当未来尚未准备好时，`poll` 返回 `Poll::Pending` 并存储从当前“上下文”复制的“Waker”的克隆。 一旦未来可以取得进展，这个“唤醒者”就会被唤醒。 例如，等待套接字变得可读的未来会在“Waker”上调用 `.clone()` 并存储它。 当一个信号到达其他地方表明套接字是可读的时，“Waker::wake”被调用并且套接字未来的任务被唤醒。 一旦任务被唤醒，它应该再次尝试“轮询”未来，这可能会也可能不会产生最终值。</p><p>When a future is not ready yet, <code>poll</code> returns <code>Poll::Pending</code> and
stores a clone of the <a href="../task/struct.Waker.html"><code>Waker</code></a> copied from the current <a href="../task/struct.Context.html" title="Context"><code>Context</code></a>.
This <a href="../task/struct.Waker.html"><code>Waker</code></a> is then woken once the future can make progress.
For example, a future waiting for a socket to become
readable would call <code>.clone()</code> on the <a href="../task/struct.Waker.html"><code>Waker</code></a> and store it.
When a signal arrives elsewhere indicating that the socket is readable,
<a href="../task/struct.Waker.html#method.wake"><code>Waker::wake</code></a> is called and the socket future’s task is awoken.
Once a task has been woken up, it should attempt to <code>poll</code> the future
again, which may or may not produce a final value.</p>
<p class="translate-text">请注意，在多次调用 `poll` 时，只有传递给最近一次调用的“上下文”中的“唤醒者”才应该被安排接收唤醒。</p><p>Note that on multiple calls to <code>poll</code>, only the <a href="../task/struct.Waker.html"><code>Waker</code></a> from the
<a href="../task/struct.Context.html" title="Context"><code>Context</code></a> passed to the most recent call should be scheduled to
receive a wakeup.</p>
<h5 id="runtime-characteristics" class="section-header"><a href="#runtime-characteristics">Runtime characteristics</a></h5>
<p class="translate-text">仅期货是惰性的； 它们必须主动“轮询”才能取得进展，这意味着每次唤醒当前任务时，它都应该主动重新“轮询”它仍然感兴趣的未决期货。</p><p>Futures alone are <em>inert</em>; they must be <em>actively</em> <code>poll</code>ed to make
progress, meaning that each time the current task is woken up, it should
actively re-<code>poll</code> pending futures that it still has an interest in.</p>
<p class="translate-text">`poll` 函数不会在一个紧密循环中重复调用——相反，它应该只在未来表明它准备好取得进展时调用（通过调用 `wake()`）。 如果你熟悉 Unix 上的 `poll(2)` 或 `select(2)` 系统调用，值得注意的是，future 通常不会遇到“所有唤醒必须轮询所有事件”的相同问题； 它们更像是 `epoll(4)`。</p><p>The <code>poll</code> function is not called repeatedly in a tight loop – instead,
it should only be called when the future indicates that it is ready to
make progress (by calling <code>wake()</code>). If you’re familiar with the
<code>poll(2)</code> or <code>select(2)</code> syscalls on Unix it’s worth noting that futures
typically do <em>not</em> suffer the same problems of “all wakeups must poll
all events”; they are more like <code>epoll(4)</code>.</p>
<p class="translate-text">`poll` 的实现应该努力快速返回，并且不应该阻塞。 快速返回可防止不必要地阻塞线程或事件循环。 如果提前知道对 `poll` 的调用可能会花费一段时间，则应将工作卸载到线程池（或类似的东西）以确保 `poll` 可以快速返回。</p><p>An implementation of <code>poll</code> should strive to return quickly, and should
not block. Returning quickly prevents unnecessarily clogging up
threads or event loops. If it is known ahead of time that a call to
<code>poll</code> may end up taking awhile, the work should be offloaded to a
thread pool (or something similar) to ensure that <code>poll</code> can return
quickly.</p>
<h5 id="panics" class="section-header"><a href="#panics">Panics</a></h5>
<p class="translate-text">一旦 future 完成（从 `poll` 返回 `Ready`），再次调用它的 `poll` 方法可能会出现panic、永远阻塞或导致其他类型的问题； `Future` 特性对这种调用的效果没有要求。 然而，由于 `poll` 方法没有标记为 `unsafe`，Rust 的通常规则适用：无论未来的状态如何，调用都不能导致未定义的行为（内存损坏、错误使用 `unsafe` 函数等）。</p><p>Once a future has completed (returned <code>Ready</code> from <code>poll</code>), calling its
<code>poll</code> method again may panic, block forever, or cause other kinds of
problems; the <code>Future</code> trait places no requirements on the effects of
such a call. However, as the <code>poll</code> method is not marked <code>unsafe</code>,
Rust’s usual rules apply: calls must never cause undefined behavior
(memory corruption, incorrect use of <code>unsafe</code> functions, or the like),
regardless of the future’s state.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/future/future.rs.html#103-109" title="goto source code">[src]</a></div><a href="#impl-Future" class="anchor"></a><h3 class="code-header in-band">impl&lt;'_, F&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="primitive" href="../primitive.reference.html">&amp;'_ mut </a>F <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> + <a class="trait" href="../marker/trait.Unpin.html" title="trait std::marker::Unpin">Unpin</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><div id="associatedtype.Output-1" class="type trait-impl has-srclink"><a href="#associatedtype.Output-1" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = &lt;F as <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>&gt;::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-1" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/panic/unwind_safe.rs.html#283-291" title="goto source code">[src]</a></div><a href="#impl-Future-1" class="anchor"></a><h3 class="code-header in-band">impl&lt;F&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="../panic/struct.AssertUnwindSafe.html" title="struct std::panic::AssertUnwindSafe">AssertUnwindSafe</a>&lt;F&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><div id="associatedtype.Output-2" class="type trait-impl has-srclink"><a href="#associatedtype.Output-2" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = &lt;F as <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>&gt;::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-2" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/alloc/boxed.rs.html#1823-1832" title="goto source code">[src]</a></div><a href="#impl-Future-2" class="anchor"></a><h3 class="code-header in-band">impl&lt;F, A&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="../boxed/struct.Box.html" title="struct std::boxed::Box">Box</a>&lt;F, A&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> + <a class="trait" href="../marker/trait.Unpin.html" title="trait std::marker::Unpin">Unpin</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;A: <a class="trait" href="../alloc/trait.Allocator.html" title="trait std::alloc::Allocator">Allocator</a> + 'static,&nbsp;</span></h3></div></summary><div class="impl-items"><div id="associatedtype.Output-3" class="type trait-impl has-srclink"><a href="#associatedtype.Output-3" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = &lt;F as <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>&gt;::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-3" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/future/future.rs.html#112-121" title="goto source code">[src]</a></div><a href="#impl-Future-3" class="anchor"></a><h3 class="code-header in-band">impl&lt;P&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="../pin/struct.Pin.html" title="struct std::pin::Pin">Pin</a>&lt;P&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;P: <a class="trait" href="../ops/trait.DerefMut.html" title="trait std::ops::DerefMut">DerefMut</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;P as <a class="trait" href="../ops/trait.Deref.html" title="trait std::ops::Deref">Deref</a>&gt;::<a class="type" href="../ops/trait.Deref.html#associatedtype.Target" title="type std::ops::Deref::Target">Target</a>: <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><div id="associatedtype.Output-4" class="type trait-impl has-srclink"><a href="#associatedtype.Output-4" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = &lt;&lt;P as <a class="trait" href="../ops/trait.Deref.html" title="trait std::ops::Deref">Deref</a>&gt;::<a class="type" href="../ops/trait.Deref.html#associatedtype.Target" title="type std::ops::Deref::Target">Target</a> as <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a>&gt;::<a class="type" href="trait.Future.html#associatedtype.Output" title="type std::future::Future::Output">Output</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-4" class="impl has-srclink"><div class="rightside"><span class="since" title="Stable since Rust version 1.48.0">1.48.0</span><a class="srclink" href="../../src/core/future/pending.rs.html#38-44" title="goto source code">[src]</a></div><a href="#impl-Future-4" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="struct.Pending.html" title="struct std::future::Pending">Pending</a>&lt;T&gt;</h3></div></summary><div class="impl-items"><div id="associatedtype.Output-5" class="type trait-impl has-srclink"><a href="#associatedtype.Output-5" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = T</h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-5" class="impl has-srclink"><div class="rightside"><span class="since" title="Stable since Rust version 1.48.0">1.48.0</span><a class="srclink" href="../../src/core/future/ready.rs.html#18-25" title="goto source code">[src]</a></div><a href="#impl-Future-5" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="struct.Ready.html" title="struct std::future::Ready">Ready</a>&lt;T&gt;</h3></div></summary><div class="impl-items"><div id="associatedtype.Output-6" class="type trait-impl has-srclink"><a href="#associatedtype.Output-6" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = T</h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-Future-6" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/future/poll_fn.rs.html#55-64" title="goto source code">[src]</a></div><a href="#impl-Future-6" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, F&gt; <a class="trait" href="trait.Future.html" title="trait std::future::Future">Future</a> for <a class="struct" href="struct.PollFn.html" title="struct std::future::PollFn">PollFn</a>&lt;F&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="../ops/trait.FnMut.html" title="trait std::ops::FnMut">FnMut</a>(&amp;mut <a class="struct" href="../task/struct.Context.html" title="struct std::task::Context">Context</a>&lt;'_&gt;) -&gt; <a class="enum" href="../task/enum.Poll.html" title="enum std::task::Poll">Poll</a>&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><div id="associatedtype.Output-7" class="type trait-impl has-srclink"><a href="#associatedtype.Output-7" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.Output" class="type">Output</a> = T</h4></div></div></details></div><script type="text/javascript" src="../../implementors/core/future/future/trait.Future.js" async=""></script></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="std" data-search-index-js="../../search-index1.58.0.js" data-search-js="../../search1.58.0.js"></div>
</body></html>